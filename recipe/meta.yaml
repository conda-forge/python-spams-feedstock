{% set version = "2.5" %}
{% set date = "2014-03-27" %}
{% set file_num = "33816" %}

{% set variant = "openblas" %}

package:
  name: python-spams
  version: {{ version }}

source:
  fn: spams-{{ version }}.tar.gz
  url: http://spams-devel.gforge.inria.fr/hitcounter2.php?file={{ file_num }}/spams-python-v{{ version }}-svn{{ date }}.tar.gz
  sha256: d61f6b940370f801e62a5c11e95ef52cc5016b97bce48ef227f4bef8afc84b24

  patches:
    # Fix how BLAS is detected. Mailed to developer.
    - setup.py.patch
    # Update bindings for NumPy 1.10.x from 1.9.x.
    - spams_wrap.cpp.patch
    - spams_wrap-windows.cpp.patch
    # Handle type mismatch issues in array creation.
    - spams.py.patch
    - test_prox.py.patch

build:
  skip: true  # [win or py3k]
  number: 205
  detect_binary_files_with_prefix: true
  features:
    - blas_{{ variant }}

requirements:
  build:
    - gcc
    - python
    - blas 1.1 {{ variant }}
    - openblas 0.2.19|0.2.19.*
    - numpy x.x
    - scipy
    # For tests.
    - pillow
    
  run:
    - libgcc
    - python
    - blas 1.1 {{ variant }}
    - openblas 0.2.19|0.2.19.*
    - numpy x.x
    - scipy

test:
  source_files:
    # Test data
    - boat.png
    - lena.png
    # Test suite
    - test_decomp.py
    - test_dictLearn.py
    - test_linalg.py
    - test_prox.py
    - test_spams.py
    - test_utils.py
  requires:
    - pillow
  imports:
    - spams

about:
  home: http://spams-devel.gforge.inria.fr/
  license: GPL 3
  summary: An optimization toolbox for solving various sparse estimation problems.

extra:
  recipe-maintainers:
    - jakirkham
